# 功能拆解与数据结构建议

本文档面向当前「Flash-JP」产品原型，围绕以下功能给出拆解与数据结构建议：

- 提升学习效率：记忆强度评分、多维提示
- 优化学习流程：学习计划、学习轨迹（日历/打卡）
- 提升交互体验：连击/节奏反馈、多状态卡片

## 1. 提升学习效率

### 1.1 记忆强度评分

**目标**：根据用户行为动态计算“熟悉度”，用于更合理的复习频率与排序。

**功能拆解**：
- **评分模型**
  - 初始记忆强度为 0（陌生）。
  - 行为加权：
    - 标记“已记/简单词”加分。
    - 停留时间过长、重复出现次数多但未记住则减分。
    - 收藏词可视为“重点词”，可提高学习频率但不一定直接加分。
- **评分更新触发**
  - 每次滑动到下一个词时，更新当前词分值。
  - 标记“已记/简单词”时立即提高评分。
  - 进入“已记列表”可作为额外权重（可选）。
- **基于评分的排序**
  - 低分优先：更易出现。
  - 高分词进入低频复习池。

**数据结构建议**：
```json
{
  "memoryStats": {
    "wordId": {
      "score": 0.0,
      "seenCount": 0,
      "correctCount": 0,
      "lastSeenAt": 0,
      "avgStudySeconds": 0
    }
  }
}
```

**字段说明**：
- `score`: 记忆强度（0~1 或 0~100）。
- `seenCount`: 该词出现次数。
- `correctCount`: 标记“已记/简单词”次数。
- `lastSeenAt`: 最近学习时间，用于衰减。
- `avgStudySeconds`: 平均停留时长，用于判断记忆难度。

---

### 1.2 多维提示

**目标**：通过逐步揭示内容降低认知负荷，提高记忆效率。

**功能拆解**：
- 默认显示 **假名/罗马音**。
- 点击卡片或按钮后显示 **汉字/释义**。
- 若用户重复点击，可增加例句或语音提示（后续扩展）。
- 支持“自动提示模式”（可选）：停留超过 X 秒后自动显示释义。

**数据结构建议**：
- 当前词的“显示阶段”可以用本地临时状态保存：
```json
{
  "cardRevealState": {
    "wordId": "kanji_hidden | kanji_shown | meaning_shown"
  }
}
```

---

## 2. 优化学习流程

### 2.1 学习计划（每日目标）

**目标**：用户可设置每日目标词数，完成后结束当天学习流程。

**功能拆解**：
- 用户设置「今日目标词数」（如 20）。
- 每完成一个记忆动作（记住/简单词），计入今日完成数。
- 当完成数达到目标时：
  - 提示“今日任务完成”。
  - 可锁定学习模式（或进入复习模式）。

**数据结构建议**：
```json
{
  "dailyPlan": {
    "target": 20,
    "completed": 8,
    "date": "2024-05-26"
  }
}
```

---

### 2.2 学习轨迹（学习日历 / 打卡）

**目标**：展示学习连续天数与累计学习天数，增强成就感。

**功能拆解**：
- 每天完成任意学习任务即打卡成功。
- 统计：
  - 连续打卡天数（streak）。
  - 累计学习天数。
  - 过去 30 天的学习分布。

**数据结构建议**：
```json
{
  "studyCalendar": {
    "2024-05-24": { "count": 10 },
    "2024-05-25": { "count": 20 },
    "2024-05-26": { "count": 5 }
  },
  "streak": 3,
  "totalDays": 12
}
```

---

## 3. 提升交互体验

### 3.1 连击 / 节奏反馈

**目标**：连续记住词时触发动画/音效反馈，提升学习节奏感。

**功能拆解**：
- 记录“连续记住次数”。
- 达到阈值时触发粒子/音效。
- 连击中断条件：
  - 跳过词。
  - 暂停或切换模式。

**数据结构建议**：
```json
{
  "combo": {
    "count": 4,
    "lastSuccessAt": 1716700000
  }
}
```

---

### 3.2 多状态卡片

**目标**：通过分步显示内容，强化主动回忆。

**功能拆解**：
- 卡片默认只显示假名/罗马音。
- 点击后显示汉字，再次点击显示释义。
- 支持用户设置固定模式（如“总是显示全部”）。

**数据结构建议**：
```json
{
  "cardMode": "step"  // step | full
}
```

---

## 4. 总结与下一步建议

1. **最优先落地**：学习计划、记忆强度评分、多状态卡片。
2. **中期增强**：连击反馈、学习轨迹日历。
3. **长期方向**：评分驱动的智能复习（结合 SRS 间隔记忆算法）。

如需可进一步细化为：
- UI 交互原型草图
- 评分算法细化
- 数据存储/持久化方案（Cookie / LocalStorage / IndexedDB）
